<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</title>
  <style>
    body {
      font-family: "Sarabun", sans-serif;
      text-align: center;
      margin-top: 50px;
      background: #f7f9fb;
    }
    input {
      padding: 8px;
      border-radius: 6px;
      border: 1px solid #ccc;
      margin: 5px;
    }
    button {
      margin: 8px;
      padding: 10px 20px;
      font-size: 16px;
      border-radius: 8px;
      border: none;
      color: white;
      cursor: pointer;
    }
    .btn-present { background-color: #4caf50; }
    .btn-late { background-color: #ff9800; }
    .btn-absent { background-color: #f44336; }
    .btn-add { background-color: #2196f3; }
  </style>
</head>
<body>
  <h2>üìã ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h2>

  <h3>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h3>
  <input type="text" id="no" placeholder="‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà">
  <input type="text" id="studentId" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ï‡∏±‡∏ß">
  <input type="text" id="newName" placeholder="‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•">
  <button class="btn-add" onclick="addStudent()">‡πÄ‡∏û‡∏¥‡πà‡∏°</button>

  <hr style="margin:30px 0;">

  <h3>‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠</h3>
  <input type="text" id="name" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠">
  <div>
    <button class="btn-present" onclick="submitStatus('‡∏°‡∏≤')">‡∏°‡∏≤</button>
    <button class="btn-late" onclick="submitStatus('‡∏™‡∏≤‡∏¢')">‡∏™‡∏≤‡∏¢</button>
    <button class="btn-absent" onclick="submitStatus('‡∏Ç‡∏≤‡∏î')">‡∏Ç‡∏≤‡∏î</button>
  </div>

  <script>
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycby4Nvgc7kiHhDjRJxLA_nFDfts8HgFwQR0yYbsOOdYXyVZFvZY0ogNUkGiAGVRWJ3oLCw/exec";

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÉ‡∏´‡∏°‡πà
    function addStudent() {
      const no = document.getElementById("no").value.trim();
      const studentId = document.getElementById("studentId").value.trim();
      const name = document.getElementById("newName").value.trim();

      if (!no || !studentId || !name) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö");

      fetch(SCRIPT_URL, {
        method: "POST",
        body: new URLSearchParams({
          action: "addStudent",
          no,
          studentId,
          name
        })
      })
      .then(res => res.text())
      .then(msg => alert(msg))
      .catch(() => alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô"));
    }

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ ‡∏°‡∏≤/‡∏™‡∏≤‡∏¢/‡∏Ç‡∏≤‡∏î
    function submitStatus(status) {
      const name = document.getElementById("name").value.trim();
      if (!name) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏ä‡πá‡∏Ñ‡∏ä‡∏∑‡πà‡∏≠");

      fetch(SCRIPT_URL, {
        method: "POST",
        body: new URLSearchParams({
          action: "checkStatus",
          name,
          status
        })
      })
      .then(res => res.text())
      .then(msg => alert(msg))
      .catch(() => alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞"));
    }
  </script>
</body>
</html>
